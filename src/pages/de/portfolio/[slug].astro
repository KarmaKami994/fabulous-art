---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { portfolioWorks, type PortfolioWork } from '@/content/portfolio/works';
import { t } from '@/i18n/utils';

const locale = 'de';

export function getStaticPaths() {
  return portfolioWorks.map((work) => ({
    params: { slug: work.slug },
  }));
}

const { slug } = Astro.params;
const work = portfolioWorks.find((w) => w.slug === slug);

if (!work) {
  return Astro.redirect('/de/portfolio');
}
---

<BaseLayout
  title={work.title}
  locale={locale}
  description={work.description.de}
>
  <section class="detail-page">
    <div class="container">

      <!-- Back Link -->
      <a href="/de/portfolio" class="detail-page__back">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"/>
          <polyline points="12 19 5 12 12 5"/>
        </svg>
        <span>{t(locale, 'portfolio.backToOverview')}</span>
      </a>

      <!-- Artwork -->
      <div class="detail-page__content fade-in">
        <div class="detail-page__image-wrap">
          <img
            src={work.imageFull}
            alt={work.title}
            class="detail-page__image"
            loading="eager"
          />
        </div>

        <div class="detail-page__info">
          <h1 class="detail-page__title">{work.title}</h1>

          <div class="detail-page__meta">
            <div class="detail-page__meta-item">
              <span class="detail-page__meta-label">Gr√∂sse</span>
              <span class="detail-page__meta-value">{work.size}</span>
            </div>
            <div class="detail-page__meta-item">
              <span class="detail-page__meta-label">Medium</span>
              <span class="detail-page__meta-value">{work.medium}</span>
            </div>
            <div class="detail-page__meta-item">
              <span class="detail-page__meta-label">Jahr</span>
              <span class="detail-page__meta-value">{work.year}</span>
            </div>
            <div class="detail-page__meta-item">
              <span class="detail-page__meta-label">Preis</span>
              <span class="detail-page__meta-value">{work.price}</span>
            </div>
          </div>

          <p class="detail-page__description">{work.description.de}</p>

          <a href="mailto:info.fabulousart@gmail.com?subject=Anfrage: {work.title}" class="btn">
            Anfrage senden
          </a>
        </div>
      </div>

    </div>
  </section>
</BaseLayout>

<style>
  .detail-page {
    padding-top: calc(var(--header-height) + var(--space-2xl));
    padding-bottom: var(--space-4xl);
  }

  /* Back Link */
  .detail-page__back {
    display: inline-flex;
    align-items: center;
    gap: var(--space-sm);
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-2xl);
    transition: color var(--transition-fast);
  }

  .detail-page__back:hover {
    color: var(--color-text);
  }

  .detail-page__back svg {
    transition: transform var(--transition-fast);
  }

  .detail-page__back:hover svg {
    transform: translateX(-4px);
  }

  /* Content Layout */
  .detail-page__content {
    display: grid;
    grid-template-columns: 1.4fr 1fr;
    gap: var(--space-3xl);
    align-items: start;
  }

  /* Image */
  .detail-page__image-wrap {
    position: relative;
    background: var(--color-gray-50);
    border-radius: var(--radius-sm);
    overflow: hidden;
  }

  .detail-page__image {
    width: 100%;
    height: auto;
    display: block;
  }

  /* Info */
  .detail-page__info {
    position: sticky;
    top: calc(var(--header-height) + var(--space-2xl));
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
  }

  .detail-page__title {
    font-family: var(--font-heading);
    font-size: var(--text-3xl);
    font-weight: 400;
    font-style: italic;
    color: var(--color-text);
  }

  .detail-page__meta {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
    padding-block: var(--space-lg);
    border-top: 1px solid var(--color-border);
    border-bottom: 1px solid var(--color-border);
  }

  .detail-page__meta-item {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
  }

  .detail-page__meta-label {
    font-size: var(--text-xs);
    font-weight: 500;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--color-text-muted);
  }

  .detail-page__meta-value {
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
  }

  .detail-page__description {
    font-size: var(--text-base);
    color: var(--color-text-secondary);
    line-height: 1.7;
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .detail-page__content {
      grid-template-columns: 1fr;
      gap: var(--space-2xl);
    }

    .detail-page__info {
      position: static;
    }
  }
</style>
